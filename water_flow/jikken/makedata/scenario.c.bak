#include <stdio.h>
#include "file.h"

#define LEN 10000
#define CLASS 3
#define TERM 3
#define CNUM 27// CLASS^TERM

int readData(FILE* fp_data, float *data){
  float val;
  int i = 0;

  while(fscanf(fp_data, "%f", &val) != EOF){
	  data[i++] = val;
 }

      return i;
}

int getClassNum(float val){
  if(val < 2.5)       { return 0; }
  else if(val < 6)  { return 1; }
  else if(val < 8)  { return 2; }
  //else if(val < 4.0)  { return 3; }
  //else if(val < 5.0)  { return 4; }
  else                { return 9; }
}

int getResultNum(int *a){
  int i, r = 0;
  for(i = 0; i < TERM; i++) { r = r * CLASS + a[-i]; } // -i で OK!
  return r;
}

int main(){
  FILE *fp_data;
  float data[LEN];
  int result[CNUM];
  int class[LEN];
  int i, n, r;

  fp_data = FILEOPEN("./mutsu_2010.txt", "r");
  n = readData(fp_data, data);
  //printf("%d\n", n);
  fclose(fp_data);

  for(i = 0; i < CNUM; i++){
	  result[i] = 0;
  }
  for(i = 0; i < n; i++){
	  class[i] = getClassNum(data[i]);
  }
  for(i = TERM - 1; i < n; i++){
    r = getResultNum(&class[i]);
    result[r]++;
    //printf("%d: %d\n", i, r);
  }
  for(i = 0; i < CNUM; i++){
    printf("Class %d: %f\n", i, (float)result[i] / (n - TERM + 1) );
  }

  return 0;
}
